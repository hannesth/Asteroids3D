{"version":3,"sources":["../src/main.js"],"names":["Quaternion","require","canvas","gl","NumVerticesSphere","NumVerticesAsteroid","count","sphereIndex","points","colors","va","vec4","vb","vc","vd","shipSpeed","refSize","refSpeed","bulletSize","bulletSpeed","viewBoxLength","initialNumberOfAsteroids","pitch","yaw","roll","eye","pitchAxis","yawAxis","rollAxis","deltaAngle","proLoc","mvLoc","vertices","triangle","a","b","c","push","quad","d","cube","divideTriangle","ab","mix","ac","bc","normalize","tetrahedron","n","List","start","end","counter","makeNode","data","next","prev","id","prototype","add","remove","jo","changePos","position","direction","speed","dPosition","Array","dx","Math","cos","radians","dy","sin","dz","sum","i","forward","Asteroid","size","floor","random","pos","dir","changePosition","wrapIfOutOfBounds","Bullet","console","log","window","onload","init","document","querySelector","WebGLUtils","setupWebGL","alert","viewport","width","height","clearColor","enable","DEPTH_TEST","program","initShaders","useProgram","vBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","flatten","STATIC_DRAW","vPosition","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","getUniformLocation","addEventListener","e","keyCode","bulletList","render","asteroidList","setTimeout","requestAnimFrame","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","proj","perspective","uniformMatrix4fv","currentAsteroid","realSize","mv","mat4","mult","scalem","rotateY","translate","drawArrays","TRIANGLES"],"mappings":"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","file":"main.js","sourcesContent":["/*\n\n  Asteroids in 3D\n*/\n\nconst Quaternion = require('quaternion');\n\nlet canvas;\nlet gl;\n\nlet NumVerticesSphere = 0;\nlet NumVerticesAsteroid = 36;\n\nlet count = 7;\n\nconst sphereIndex = 0;\n\nconst points = [];\nconst colors = [];\n\nconst va = vec4(0.0, 0.0, -1.0,1);\nconst vb = vec4(0.0, 0.942809, 0.333333, 1);\nconst vc = vec4(-0.816497, -0.471405, 0.333333, 1);\nconst vd = vec4(0.816497, -0.471405, 0.333333,1);\n\nconst shipSpeed = 0.02;\n\nconst refSize = 0.2;\nconst refSpeed = 0.01;\n\nconst bulletSize = 0.02;\nconst bulletSpeed = 0.02;\n\nconst viewBoxLength = 15.0;\n\nconst initialNumberOfAsteroids = 40;\n\nlet pitch = 0.0;\nlet yaw = 0.0;\nlet roll = 0.0;\nlet eye = [0.0, 0.0, 0.0];\nlet pitchAxis = [1.0, 0.0, 0.0];\nlet yawAxis = [0.0, 1.0, 0.0];\nlet rollAxis = [0.0, 0.0, -1.0];\nconst deltaAngle = 1;\n\n\nlet proLoc;\nlet mvLoc;\n\nconst vertices = [\n  vec4( -0.5, -0.5,  0.5, 1.0 ),\n  vec4( -0.5,  0.5,  0.5, 1.0 ),\n  vec4(  0.5,  0.5,  0.5, 1.0 ),\n  vec4(  0.5, -0.5,  0.5, 1.0 ),\n  vec4( -0.5, -0.5, -0.5, 1.0 ),\n  vec4( -0.5,  0.5, -0.5, 1.0 ),\n  vec4(  0.5,  0.5, -0.5, 1.0 ),\n  vec4(  0.5, -0.5, -0.5, 1.0 )\n];\n\nfunction triangle(a, b, c) {\n\n  points.push(a);\n  points.push(b);\n  points.push(c);\n\n  NumVerticesSphere+= 3;\n}\n\nfunction quad(a, b, c, d) {\n  points.push(vertices[a]);\n  points.push(vertices[b]);\n  points.push(vertices[c]);\n  points.push(vertices[a]);\n  points.push(vertices[c]);\n  points.push(vertices[d]);\n}\n\n\nfunction cube() {\n  quad( 1, 0, 3, 2 );\n  quad( 2, 3, 7, 6 );\n  quad( 3, 0, 4, 7 );\n  quad( 6, 5, 1, 2 );\n  quad( 4, 5, 6, 7 );\n  quad( 5, 4, 0, 1 );\n}\n\nfunction divideTriangle(a, b, c, count) {\n  if ( count > 0 ) {\n\n    var ab = mix( a, b, 0.5);\n    var ac = mix( a, c, 0.5);\n    var bc = mix( b, c, 0.5);\n\n    ab = normalize(ab, true);\n    ac = normalize(ac, true);\n    bc = normalize(bc, true);\n\n    divideTriangle( a, ab, ac, count - 1 );\n    divideTriangle( ab, b, bc, count - 1 );\n    divideTriangle( bc, c, ac, count - 1 );\n    divideTriangle( ab, bc, ac, count - 1 );\n  }\n  else {\n    triangle( a, b, c );\n  }\n}\n\n\nfunction tetrahedron(a, b, c, d, n) {\n    divideTriangle(a, b, c, n);\n    divideTriangle(d, c, b, n);\n    divideTriangle(a, d, b, n);\n    divideTriangle(a, c, d, n);\n}\n\nfunction List() {\n  this.start = null;\n  this.end = null;\n  this.counter = 0;\n}\n\nList.makeNode = function () {\n  return { data: null, next: null, prev: null, id: null};\n};\n\nList.prototype.add = function(data) {\n  if (this.start===null){\n    this.start=List.makeNode();\n    this.end=this.start;\n  } else {\n    this.end.next = List.makeNode();\n    this.end.next.prev = this.end;\n    this.end = this.end.next;\n  }\n  this.end.data = data;\n}\n\nList.prototype.remove = function(id) {\n  let jo = this.start;\n\n  while (jo != null) {\n    if (jo.id === id) {\n      jo.prev.next = jo.next;\n    } else {\n      jo = jo.next;\n    }\n  }\n}\n\nfunction changePos(position, direction, speed) {\n  let dPosition = new Array(3);\n  let dx = speed*Math.cos(radians(direction[0]))*Math.cos(radians(direction[1]));\n  let dy = speed*Math.sin(radians(direction[0]))*Math.cos(radians(direction[1]));\n  let dz = speed*Math.cos(radians(direction[0]))*Math.sin(radians(direction[1]));\n  dPosition = [dx, dy, dy];\n\n  let sum = new Array(3);\n  for(let i = 0; i <= 2; i++){\n      sum[i] = position[i] + dPosition[i];\n  }\n\n  return sum;\n}\n\n\nfunction forward() {\n  eye[0] =  eye[0] - shipSpeed*Math.sin(radians(yaw));\n  eye[2] =  eye[2] - shipSpeed*Math.cos(radians(yaw));\n}\n\n//Asteroid \"Class\" description:\n// Three types of sizes for asteroids.\n// If value is zero then it is not drawn\n// Vector of length maxNumber.\n// Possible values : {0, 1, 2, 3}\n\n\n// Two angles theta and phi for 3D direction\n// Matrix of size maxNumber x 2\n// -180 < theta < 180\n// -90< phi < 90\nfunction Asteroid() {\n\n  this.size = Math.floor(Math.random()*3.0) + 1.0;\n\n  let pos = new Array(3);\n  pos[0] = Math.random()*(viewBoxLength-this.size) - (viewBoxLength-this.size)/2.0;\n  pos[1] = Math.random()*(viewBoxLength-this.size) - (viewBoxLength-this.size)/2.0;\n  pos[2] = Math.random()*(viewBoxLength-this.size) - (viewBoxLength-this.size)/2.0;\n  this.position = pos;\n\n  let dir = new Array(2);\n  dir[0] = Math.random()*360 - 180;\n  dir[1] = Math.random()*180 - 90;\n  this.direction = dir;\n\n  this.speed = (4-this.size)*refSpeed;\n}\nAsteroid.prototype.changePosition = function() {\n  this.position = changePos(this.position, this.direction, this.speed);\n};\n\nAsteroid.prototype.wrapIfOutOfBounds = function() {\n  let pos = this.position;\n  if(pos[0] < -viewBoxLength){\n      pos[0] = viewBoxLength;\n  }\n  if(pos[0] > viewBoxLength){\n      pos[0] = -viewBoxLength;\n  }\n  if(pos[1] < -viewBoxLength){\n      pos[1] = viewBoxLength;\n  }\n  if(pos[1] > viewBoxLength){\n      pos[1] = -viewBoxLength;\n  }\n  if(pos[2] < -viewBoxLength){\n      pos[2] = viewBoxLength;\n  }\n  if(pos[2] > viewBoxLength){\n      pos[2] = -viewBoxLength;\n  }\n\n  this.position = pos;\n};\n\nfunction Bullet() {\n  this.position = eye;\n\n  this.direction = [yaw, pitch];\n}\n\nBullet.prototype.changePosition = function() {\n  console.log(this.position);\n  this.position = changePos(this.position, this.direction, bulletSpeed);\n};\n\nBullet.prototype.wrapIfOutOfBounds = function() {\n  let pos = this.position;\n  if(pos[0] < -viewBoxLength){\n      pos[0] = viewBoxLength;\n  }\n  if(pos[0] > viewBoxLength){\n      pos[0] = -viewBoxLength;\n  }\n  if(pos[1] < -viewBoxLength){\n      pos[1] = viewBoxLength;\n  }\n  if(pos[1] > viewBoxLength){\n      pos[1] = -viewBoxLength;\n  }\n  if(pos[2] < -viewBoxLength){\n      pos[2] = viewBoxLength;\n  }\n  if(pos[2] > viewBoxLength){\n      pos[2] = -viewBoxLength;\n  }\n\n  this.position = pos;\n};\n\nwindow.onload = function init()\n{\n  canvas = document.querySelector( \"canvas\" );\n\n  gl = WebGLUtils.setupWebGL( canvas );\n  if ( !gl ) { alert( \"WebGL isn't available\" ); }\n\n  // insert vertices into array: points\n  cube();\n  tetrahedron(va, vb, vc, vd, count);\n\n  gl.viewport( 0, 0, canvas.width, canvas.height );\n  gl.clearColor( 0.0, 0.0, 0.0, 1.0 );\n\n  gl.enable(gl.DEPTH_TEST);\n\n  //\n  //  Load shaders and initialize attribute buffers\n  //\n  let program = initShaders( gl, \"vertex-shader\", \"fragment-shader\" );\n  gl.useProgram( program );\n\n  let vBuffer = gl.createBuffer();\n  gl.bindBuffer( gl.ARRAY_BUFFER, vBuffer );\n  gl.bufferData( gl.ARRAY_BUFFER, flatten(points), gl.STATIC_DRAW );\n\n  let vPosition = gl.getAttribLocation( program, \"vPosition\" );\n  gl.vertexAttribPointer( vPosition, 4, gl.FLOAT, false, 0, 0 );\n  gl.enableVertexAttribArray( vPosition );\n\n  proLoc = gl.getUniformLocation( program, \"projectionMatrix\" );\n  mvLoc = gl.getUniformLocation( program, \"modelViewMatrix\" );\n\n  // Event listener for keyboard\n  window.addEventListener(\"keydown\", function(e){\n    switch( e.keyCode ) {\n      case 38:    // upp ör\n          eye[1] += shipSpeed;\n          break;\n      case 40:    // niður ör\n          eye[1] -= shipSpeed;\n          break;\n      case 37:    // vinstri ör\n          yaw += deltaAngle;\n          break;\n      case 39:    // hægri ör\n          yaw -= deltaAngle;\n          break;\n      case 88:    // x\n          bulletList.add(new Bullet());\n          break;\n      case 90:    // z\n          forward();\n          break;\n    }\n  });\n\n  render();\n}\n\n\n// Initialize asteroids\nlet asteroidList = new List();\nfor(let i=1; i <= initialNumberOfAsteroids; i++){\n  asteroidList.add(new Asteroid(3));\n}\n\nlet bulletList = new List();\n\n//  Render the view\nfunction render()\n{\n  setTimeout(function() {\n      window.requestAnimFrame( render );\n      gl.clear( gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n      //  proj = perspective(fovy, aspect, near, far)\n      let proj = perspective( 75.0, 1.0, 0.2, 100.0 );\n      gl.uniformMatrix4fv(proLoc, false, flatten(proj));\n\n\n      let currentAsteroid = asteroidList.start;\n      while (currentAsteroid !== null) {\n\n        let position = currentAsteroid.data.position;\n        let realSize = refSize*currentAsteroid.data.size;\n        let mv = mat4();\n        mv = mult(mv, scalem(realSize, realSize, realSize));\n        mv = mult(mv, rotateY(yaw));\n        mv = mult(mv, translate(-eye[0], -eye[1], -eye[2]));\n        mv = mult(mv, translate(position[0], position[1], position[2]));\n\n\n        gl.uniformMatrix4fv(mvLoc, false, flatten(mv));\n        gl.drawArrays( gl.TRIANGLES, 0, NumVerticesAsteroid );\n\n        currentAsteroid.data.changePosition();\n        currentAsteroid.data.wrapIfOutOfBounds();\n\n        currentAsteroid = currentAsteroid.next;\n      }\n\n      /*\n      let currentBullet = bulletList.start;\n      while (currentBullet !== null) {\n\n        position = currentBullet.data.position;\n\n        mv = pitchYawView(eye, pitch, yaw);\n        mv = mult( mv, scalem(bulletSize, bulletSize, bulletSize));\n        mv = mult( mv, translate(position[0], position[1], position[2]));\n\n        gl.uniformMatrix4fv(mvLoc, false, flatten(mv));\n        gl.drawArrays( gl.TRIANGLES, NumVerticesAsteroid, NumVerticesSphere );\n\n        currentBullet.data.changePosition();\n        currentBullet.data.wrapIfOutOfBounds();\n\n        currentBullet = currentBullet.next;\n      }\n\n      */\n\n  }, 25)\n}\n"]}