{"version":3,"sources":["../src/script.js"],"names":["canvas","gl","NumVertices","program","points","colors","xAxis","yAxis","zAxis","axis","theta","movement","spinX","spinY","origX","origY","maxNumber","refSize","refSpeed","consoleCount","viewBoxLength","initialNumberOfAsteroids","pitch","yaw","dPitch","dYaw","eye","delta","deltaAngle","mv","axisRotationMatrix","proLoc","mvLoc","vertices","vec4","vertexColors","quad","a","b","c","d","push","colorCube","List","start","end","makeNode","data","next","prototype","add","Asteroid","size","Math","floor","random","pos","Array","position","dir","direction","speed","setPosition","getSize","getPosition","getDirection","getSpeed","changePosition","dPosition","dx","cos","radians","dy","sin","dz","sum","i","wrapIfOutOfBounds","window","onload","init","document","querySelector","WebGLUtils","setupWebGL","alert","viewport","width","height","clearColor","enable","DEPTH_TEST","initShaders","useProgram","vBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","flatten","STATIC_DRAW","vPosition","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","cBuffer","vColor","getUniformLocation","addEventListener","e","keyCode","render","asteroidList","setTimeout","requestAnimFrame","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","proj","perspective","uniformMatrix4fv","mvStack","pitchYawView","realSize","currentAsteroid","mult","translate","scalem","drawArrays","TRIANGLES","pop"],"mappings":"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","file":"script.js","sourcesContent":["/////////////////////////////////////////////////////////////////\r\n//      Asteroids in 3D\r\n//      based upon cube-tex.js\r\n//      by Hjálmtýr Hafsteinsson, mars 2017\r\n//\r\n//\r\n/////////////////////////////////////////////////////////////////\r\n\r\n\r\nlet canvas;\r\nlet gl;\r\n\r\nlet NumVertices  = 36;\r\n\r\nlet program;\r\n\r\nlet points = [];\r\nlet colors = [];\r\n\r\nlet xAxis = 0;\r\nlet yAxis = 1;\r\nlet zAxis = 2;\r\n\r\nlet axis = 0;\r\nlet theta = [ 0, 0, 0 ];\r\n\r\nlet movement = false;     // Do we rotate?\r\nlet spinX = 0;\r\nlet spinY = 0;\r\nlet origX;\r\nlet origY;\r\n\r\nlet maxNumber = 20;\r\nlet refSize = 0.2;\r\nlet refSpeed = 0.01;\r\nlet consoleCount = 0;\r\n\r\nlet viewBoxLength = 15.0;\r\n\r\nlet initialNumberOfAsteroids = 40;\r\n\r\nlet pitch = 0.0;\r\nlet yaw = 0.0;\r\nlet dPitch = 5.0;\r\nlet dYaw = 5.0;\r\nlet eye = [0.0, 0.0, 0.0];\r\nlet delta = 0.0;\r\nlet deltaAngle = 0.5;\r\n\r\n\r\nlet mv;\r\n\r\nlet axisRotationMatrix;\r\n\r\n\r\nlet proLoc;\r\nlet mvLoc;\r\n\r\nvar vertices = [\r\n    vec4( -0.5, -0.5,  0.5, 1.0 ),\r\n    vec4( -0.5,  0.5,  0.5, 1.0 ),\r\n    vec4(  0.5,  0.5,  0.5, 1.0 ),\r\n    vec4(  0.5, -0.5,  0.5, 1.0 ),\r\n    vec4( -0.5, -0.5, -0.5, 1.0 ),\r\n    vec4( -0.5,  0.5, -0.5, 1.0 ),\r\n    vec4(  0.5,  0.5, -0.5, 1.0 ),\r\n    vec4(  0.5, -0.5, -0.5, 1.0 )\r\n];\r\n\r\n// RGBA colors\r\nvar vertexColors = [\r\n    vec4( 0.0, 0.0, 0.0, 1.0 ),  // black\r\n    vec4( 1.0, 0.0, 0.0, 1.0 ),  // red\r\n    vec4( 1.0, 1.0, 0.0, 1.0 ),  // yellow\r\n    vec4( 0.0, 1.0, 0.0, 1.0 ),  // green\r\n    vec4( 0.0, 0.0, 1.0, 1.0 ),  // blue\r\n    vec4( 1.0, 0.0, 1.0, 1.0 ),  // magenta\r\n    vec4( 0.0, 1.0, 1.0, 1.0 ),  // cyan\r\n    vec4( 1.0, 1.0, 1.0, 1.0 )  // white\r\n];\r\n\r\nfunction quad(  a,  b,  c,  d ) {\r\n    colors.push(vertexColors[a]);\r\n    points.push(vertices[a]);\r\n    colors.push(vertexColors[a]);\r\n    points.push(vertices[b]);\r\n    colors.push(vertexColors[a]);\r\n    points.push(vertices[c]);\r\n    colors.push(vertexColors[a]);\r\n    points.push(vertices[a]);\r\n    colors.push(vertexColors[a]);\r\n    points.push(vertices[c]);\r\n    colors.push(vertexColors[a]);\r\n    points.push(vertices[d]);\r\n}\r\n\r\n\r\nfunction colorCube() {\r\n    quad( 1, 0, 3, 2 );\r\n    quad( 2, 3, 7, 6 );\r\n    quad( 3, 0, 4, 7 );\r\n    quad( 6, 5, 1, 2 );\r\n    quad( 4, 5, 6, 7 );\r\n    quad( 5, 4, 0, 1 );\r\n}\r\n\r\nfunction List() {\r\n    this.start = null;\r\n    this.end = null;\r\n\r\n}\r\n\r\nList.makeNode = function(){\r\n    return {data:null, next:null};\r\n};\r\n\r\nList.prototype.add = function(data){\r\n    if(this.start===null){\r\n        this.start=List.makeNode();\r\n        this.end=this.start;\r\n    }\r\n    else {\r\n        this.end.next = List.makeNode();\r\n        this.end = this.end.next;\r\n    }\r\n    this.end.data = data;\r\n}\r\n\r\n\r\n\r\n\r\n//Asteroid \"Class\" description:\r\n// Three types of sizes for asteroids.\r\n// If value is zero then it is not drawn\r\n// Vector of length maxNumber.\r\n// Possible values : {0, 1, 2, 3}\r\n\r\n\r\n// Two angles theta and phi for 3D direction\r\n// Matrix of size maxNumber x 2\r\n// -180 < theta < 180\r\n// -90< phi < 90\r\nfunction Asteroid() {\r\n\r\n    this.size = Math.floor(Math.random()*3.0) + 1.0;\r\n\r\n    let pos = new Array(3);\r\n    pos[0] = Math.random()*(viewBoxLength-this.size) - (viewBoxLength-this.size)/2.0;\r\n    pos[1] = Math.random()*(viewBoxLength-this.size) - (viewBoxLength-this.size)/2.0;\r\n    pos[2] = Math.random()*(viewBoxLength-this.size) - (viewBoxLength-this.size)/2.0;\r\n    this.position = pos;\r\n\r\n    let dir = new Array(2);\r\n    dir[0] = Math.random()*360 - 180;\r\n    dir[1] = Math.random()*180 - 90;\r\n    this.direction = dir;\r\n\r\n    this.speed = (4-this.size)*refSpeed;\r\n}\r\n\r\nAsteroid.prototype.setPosition = function(pos) {\r\n        this.position = pos;\r\n};\r\n\r\nAsteroid.prototype.getSize = function() {\r\n        return this.size;\r\n};\r\nAsteroid.prototype.getPosition = function() {\r\n        return this.position;\r\n};\r\nAsteroid.prototype.getDirection = function() {\r\n        return this.direction;\r\n};\r\nAsteroid.prototype.getSpeed = function() {\r\n        return this.speed;\r\n};\r\nAsteroid.prototype.changePosition = function() {\r\n        let position = this.position;\r\n        let direction = this.direction;\r\n        let speed = this.speed;\r\n\r\n        let dPosition = new Array(3);\r\n        let dx = speed*Math.cos(radians(direction[0]))*Math.cos(radians(direction[1]));\r\n        let dy = speed*Math.sin(radians(direction[0]))*Math.cos(radians(direction[1]));\r\n        let dz = speed*Math.cos(radians(direction[0]))*Math.sin(radians(direction[1]));\r\n        dPosition = [dx, dy, dy];\r\n\r\n        let sum = new Array(3);\r\n        for(let i = 0; i <= 2; i++){\r\n            sum[i] = position[i] + dPosition[i];\r\n        }\r\n\r\n        this.position = sum;\r\n};\r\n\r\nAsteroid.prototype.wrapIfOutOfBounds = function() {\r\n    let pos = this.position;\r\n    if(pos[0] < -viewBoxLength){\r\n        pos[0] = viewBoxLength;\r\n    }\r\n    if(pos[0] > viewBoxLength){\r\n        pos[0] = -viewBoxLength;\r\n    }\r\n    if(pos[1] < -viewBoxLength){\r\n        pos[1] = viewBoxLength;\r\n    }\r\n    if(pos[1] > viewBoxLength){\r\n        pos[1] = -viewBoxLength;\r\n    }\r\n    if(pos[2] < -viewBoxLength){\r\n        pos[2] = viewBoxLength;\r\n    }\r\n    if(pos[2] > viewBoxLength){\r\n        pos[2] = -viewBoxLength;\r\n    }\r\n\r\n    this.position = pos;\r\n};\r\n\r\n\r\n\r\nwindow.onload = function init()\r\n{\r\n    canvas = document.querySelector( \"canvas\" );\r\n\r\n    gl = WebGLUtils.setupWebGL( canvas );\r\n    if ( !gl ) { alert( \"WebGL isn't available\" ); }\r\n\r\n    colorCube();\r\n\r\n    gl.viewport( 0, 0, canvas.width, canvas.height );\r\n    gl.clearColor( 0.0, 0.0, 0.0, 1.0 );\r\n\r\n    gl.enable(gl.DEPTH_TEST);\r\n\r\n    //\r\n    //  Load shaders and initialize attribute buffers\r\n    //\r\n    let program = initShaders( gl, \"vertex-shader\", \"fragment-shader\" );\r\n    gl.useProgram( program );\r\n\r\n    let vBuffer = gl.createBuffer();\r\n    gl.bindBuffer( gl.ARRAY_BUFFER, vBuffer );\r\n    gl.bufferData( gl.ARRAY_BUFFER, flatten(points), gl.STATIC_DRAW );\r\n\r\n    let vPosition = gl.getAttribLocation( program, \"vPosition\" );\r\n    gl.vertexAttribPointer( vPosition, 4, gl.FLOAT, false, 0, 0 );\r\n    gl.enableVertexAttribArray( vPosition );\r\n\r\n    cBuffer = gl.createBuffer();\r\n    gl.bindBuffer( gl.ARRAY_BUFFER, cBuffer );\r\n    gl.bufferData( gl.ARRAY_BUFFER, flatten(colors), gl.STATIC_DRAW );\r\n\r\n    var vColor = gl.getAttribLocation( program, \"vColor\" );\r\n    gl.vertexAttribPointer( vColor, 4, gl.FLOAT, false, 0, 0 );\r\n    gl.enableVertexAttribArray( vColor );\r\n\r\n    proLoc = gl.getUniformLocation( program, \"projectionMatrix\" );\r\n    mvLoc = gl.getUniformLocation( program, \"modelViewMatrix\" );\r\n\r\n    // Event listener for keyboard\r\n     window.addEventListener(\"keydown\", function(e){\r\n         switch( e.keyCode ) {\r\n            case 38:    // upp ör\r\n                if(pitch<90){\r\n                    pitch += deltaAngle;\r\n                }\r\n                break;\r\n            case 40:    // niður ör\r\n                if(pitch>-90){\r\n                    pitch -= deltaAngle;\r\n                }\r\n                break;\r\n            case 37:    // vinstri ör\r\n                yaw += deltaAngle;\r\n                break;\r\n            case 39:    // hægri ör\r\n                yaw -= deltaAngle;\r\n                break;\r\n            case 32:    // bilstöng\r\n                delta += 10;\r\n                break;\r\n         }\r\n     }  );\r\n\r\n\r\n    render();\r\n}\r\n\r\n\r\n// Initialize asteroids\r\nlet asteroidList = new List();\r\nfor(let i=1; i <= initialNumberOfAsteroids; i++){\r\n    asteroidList.add(new Asteroid(3));\r\n}\r\n\r\n//  Render the view\r\nfunction render()\r\n{\r\n    setTimeout(function() {\r\n        window.requestAnimFrame( render );\r\n        gl.clear( gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n        //  proj = perspective(fovy, aspect, near, far)\r\n        let proj = perspective( 50.0, 1.0, 0.2, 100.0 );\r\n        gl.uniformMatrix4fv(proLoc, false, flatten(proj));\r\n\r\n        let mvStack = [];\r\n\r\n\r\n        mv = pitchYawView(eye, pitch, yaw);\r\n\r\n\r\n        let position;\r\n        let realSize;\r\n        let currentAsteroid = asteroidList.start;\r\n        while (currentAsteroid !== null) {\r\n            mvStack.push(mv);\r\n\r\n            position = currentAsteroid.data.getPosition();\r\n            realSize = refSize*currentAsteroid.data.size;\r\n\r\n            mv = mult( mv, translate(position[0], position[1], position[2]));\r\n            mv = mult( mv, scalem(realSize, realSize, realSize));\r\n\r\n            gl.uniformMatrix4fv(mvLoc, false, flatten(mv));\r\n            gl.drawArrays( gl.TRIANGLES, 0, NumVertices );\r\n\r\n            mv = mvStack.pop();\r\n\r\n            currentAsteroid.data.changePosition();\r\n            currentAsteroid.data.wrapIfOutOfBounds();\r\n\r\n            currentAsteroid = currentAsteroid.next;\r\n        }\r\n    }, 25)\r\n}\r\n"]}